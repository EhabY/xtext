pipeline {
  agent any

  environment {
    DOWNLOAD_AREA = '/home/data/httpd/download.eclipse.org/modeling/tmf/xtext/monorepo'
    REPOSITORY_PATH="${DOWNLOAD_AREA}/updates/nightly"
  }

  tools {
    maven "apache-maven-3.8.6"
    jdk "temurin-jdk17-latest"
  }

  stages {
    stage('Prepare repository path') {
      steps {
        sshagent(['projects-storage.eclipse.org-bot-ssh']) {
          sh '''
            echo ${REPOSITORY_PATH}
            ssh genie.xtext@projects-storage.eclipse.org "mkdir -p $REPOSITORY_PATH"
            ssh genie.xtext@projects-storage.eclipse.org "ls -l $REPOSITORY_PATH"
          '''
        }
      }
    }
  }

  post {
    success {
      archiveArtifacts artifacts: 'build/**'
    }
  }
}